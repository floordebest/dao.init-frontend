(this["webpackJsonpdao.init-frontend"]=this["webpackJsonpdao.init-frontend"]||[]).push([[0],{166:function(e,t,a){e.exports=a(298)},180:function(e,t){},295:function(e,t,a){},298:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(32),l=a.n(c),o=a(153),i=a(14),s=a.n(i),u=a(27),m=a(13),d=a(312),p=a(16),f=a.n(p),E=a(8),h=a(308),b=function(e){return e.split("-").map((function(e){return e.replace(new RegExp("^.","gm"),(function(e){return e.toUpperCase()}))})).join(" ")},g=function(e){return"object"===typeof e?"time"in e?e.time:"timep"in e?e.timep:"int"in e?"string"===typeof e.int?e.int:e.int.toFixed():"decimal"in e?"string"===typeof e.decimal?e.decimal:e.decimal.toFixed():JSON.stringify(e,void 0,2):"boolean"===typeof e?e.toString():"string"===typeof e?e:"number"===typeof e?e.toFixed():JSON.stringify(e,void 0,2)},k=function e(t){var a=t.json||{},n=t.removeMargin||!1,c=t.header||[],l=t.keyFormatter?t.keyFormatter:function(e){return e},o=t.valFormatter?t.valFormatter:function(e){return r.a.createElement("code",null,g(e))};return r.a.createElement(h.a,{simple:!0,collapsing:!0,celled:!0,style:n?{margin:"0 auto","border-radius":"0"}:{}},r.a.createElement(h.a.Header,null,r.a.createElement(h.a.Row,null,c.map((function(e){return r.a.createElement(h.a.HeaderCell,null,e)})))),r.a.createElement(h.a.Body,null,Object.entries(a).map((function(t){var a,n=Object(m.a)(t,2),c=n[0],i=n[1];return r.a.createElement(h.a.Row,null,r.a.createElement(h.a.Cell,null,r.a.createElement("h4",null,l(c))),"object"!==typeof(a=i)||"timep"in a||"int"in a||"decimal"in a||"time"in a?r.a.createElement(h.a.Cell,null,o(i)):"object"===typeof i?r.a.createElement(e,{json:i,keyFormatter:l,valFormatter:o,removeMargin:!0}):"function"===typeof i?r.a.createElement(h.a.Cell,null,o(i.toString())):r.a.createElement(h.a.Cell,null,o(i)))}))))},v=a(309),x=a(306),y=a(307),w=a(310),A=a(43),j=function(e){var t=Object(n.useState)(!1),a=Object(m.a)(t,2),c=(a[0],a[1]),l=e.tx,o=e.res,i=e.txStatus;return r.a.createElement("div",{key:l.hash},"pending"===i?O(l,c):"success"===i?S(l,c):"failure"===i?I(l,o,c):"timeout"===i?P(l,c):"validation-error"===i?C(l,o,c):r.a.createElement("div",null))},O=function(e,t){return r.a.createElement(v.a,{icon:!0,attached:"bottom",info:!0,onDismiss:t(!0)},r.a.createElement(A.a,{name:"circle notched",loading:!0}),r.a.createElement(v.a.Content,null,r.a.createElement(v.a.Header,null,"Transaction Sent"),r.a.createElement("p",null,"Awaiting Confirmation"),r.a.createElement("a",{href:"".concat(E.kadenaAPI.explorerURL,"/tx/").concat(e.hash)},"View transaction in Block Explorer")))},S=function(e,t){return r.a.createElement(v.a,{icon:!0,attached:"bottom",info:!0,onDismiss:t(!0)},r.a.createElement(A.a,{name:"check square outline"}),r.a.createElement(v.a.Content,null,r.a.createElement(v.a.Header,null,"Transaction Confirmed"),r.a.createElement("a",{href:"".concat(E.kadenaAPI.explorerURL,"/tx/").concat(e.hash)},"View transaction in Block Explorer")))},I=function(e,t,a){return r.a.createElement(v.a,{icon:!0,attached:"bottom",error:!0,onDismiss:a(!0)},r.a.createElement(A.a,{name:"exclamation"}),r.a.createElement(v.a.Content,null,r.a.createElement(v.a.Header,null,"Transaction Failure"),r.a.createElement("p",null,JSON.stringify(t,void 0,2)),r.a.createElement("a",{href:"".concat(E.kadenaAPI.explorerURL,"/tx/").concat(e.hash)},"View transaction in Block Explorer")))},C=function(e,t,a){return r.a.createElement(v.a,{icon:!0,attached:"bottom",error:!0,onDismiss:a(!0)},r.a.createElement(A.a,{name:"exclamation"}),r.a.createElement(v.a.Content,null,r.a.createElement(v.a.Header,null,"Transaction Validation Failure"),"Transaction was not sent to Blockchain. Check your keys or metadata"))},P=function(e,t){return r.a.createElement(v.a,{icon:!0,attached:"bottom",warning:!0,onDismiss:t(!0)},r.a.createElement(A.a,{name:"hourglass outline"}),r.a.createElement(v.a.Content,null,r.a.createElement(v.a.Header,null,"Transaction Timeout"),"...but your tx was sent.",r.a.createElement("a",{href:"".concat(E.kadenaAPI.explorerURL,"/tx/").concat(e.hash)},"View transaction in Block Explorer")))},F=function(){var e=Object(u.a)(s.a.mark((function e(t,a,n,r,c,l){var o,i,u,m,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o={pactCode:a,caps:f.a.lang.mkCap("Guadian Cap","Authenticates that your a guardian","".concat(E.kadenaAPI.contractAddress,".GUARDIAN"),[t]),gasLimit:E.kadenaAPI.meta.gasLimit,chainId:E.kadenaAPI.meta.chainId,ttl:E.kadenaAPI.meta.ttl,sender:t,envData:n||{}},console.log("toSign",o),e.next=5,f.a.wallet.sign(o);case 5:return i=e.sent,console.log("signed",i),r(i),e.next=10,f.a.wallet.sendSigned(i,E.kadenaAPI.meta.host);case 10:u=e.sent,console.log("txReqKeys",u),c("pending"),e.prev=13,m=8,d={};case 16:if(!(m>0)){e.next=25;break}return e.next=19,new Promise((function(e){return setTimeout(e,15e3)}));case 19:return e.next=21,f.a.fetch.poll(u,E.kadenaAPI.meta.host);case 21:d=e.sent;try{d[i.hash].result.status?m=-1:m-=1}catch(s){m-=1}e.next=16;break;case 25:l(d),"success"===d[i.hash].result.status?(console.log("tx status set to success"),c("success")):0==m?(console.log("tx status set to timeout"),c("timeout")):(console.log("tx status set to failure"),c("failure")),e.next=35;break;case 30:e.prev=30,e.t0=e.catch(13),console.log("tx api failure",e.t0),l(e.t0),c("failure");case 35:e.next=42;break;case 37:e.prev=37,e.t1=e.catch(0),console.log(e.t1),console.log("tx status set to validation error"),c("validation-error");case 42:case"end":return e.stop()}}),e,null,[[0,37],[13,30]])})));return function(t,a,n,r,c,l){return e.apply(this,arguments)}}(),R=function(e){return r.a.createElement("table",{className:"ui very basic collapsing celled table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Guardian"),r.a.createElement("th",null,"Committed KDA"),r.a.createElement("th",null,"Approved Hash"),r.a.createElement("th",null,"Approval Date"),r.a.createElement("th",null,"Guard"))),r.a.createElement("tbody",null,e.guardians.map((function(e){return r.a.createElement("tr",{key:e.k},r.a.createElement("td",null,e.k),r.a.createElement("td",null,g(e["committed-kda"])),r.a.createElement("td",null,e["approved-hash"]),r.a.createElement("td",null,g(e["approved-date"])),r.a.createElement("td",null,g(e.guard)))}))))},T=function(e){var t=Object(n.useState)(""),a=Object(m.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(""),i=Object(m.a)(o,2),s=i[0],u=i[1],d=Object(n.useState)(""),p=Object(m.a)(d,2),f=p[0],h=p[1],b=Object(n.useState)(""),g=Object(m.a)(b,2),k=g[0],A=g[1],O=Object(n.useState)({}),S=Object(m.a)(O,2),I=S[0],C=S[1],P=Object(n.useState)({}),R=Object(m.a)(P,2),T=R[0],D=R[1];return r.a.createElement("div",null,r.a.createElement(v.a,{attached:!0,header:"Add Ambassador"}),r.a.createElement(x.a,{onSubmit:function(e){e.preventDefault(),console.log(c,s,f),F(c,"(".concat(E.kadenaAPI.contractAddress,'.register-ambassador "').concat(c,'" "').concat(s,"\" (read-keyset 'ks))"),{ks:JSON.parse(f)},C,A,D)},className:"attached fluid segment"},r.a.createElement(y.a,{fluid:!0,search:!0,selection:!0,placeholder:"Select Guardian",required:!0,options:e.guardians.map((function(e){return{key:e.k,value:e.k,text:e.k}})),onChange:function(e,t){l(t.value)}}),r.a.createElement(x.a.Field,{required:!0},r.a.createElement("label",null,"Ambassador Account Name"),r.a.createElement("input",{value:s,onChange:function(e){return u(e.target.value)}})),r.a.createElement(x.a.TextArea,{required:!0,label:"Ambassador Account Guard",placeholder:JSON.stringify({pred:"keys-all",keys:["8c59a322800b3650f9fc5b6742aa845bc1c35c2625dabfe5a9e9a4cada32c543"]},void 0,2),value:f,onChange:function(e){return h(e.target.value)}}),r.a.createElement(w.a,{color:"blue",type:"submit"},"Submit")),r.a.createElement(j,{tx:I,txRes:T,txStatus:k}))},D=function(e){return r.a.createElement("table",{className:"ui very basic collapsing celled table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Ambassador"),r.a.createElement("th",null,"Active"),r.a.createElement("th",null,"Voted To Freeze"),r.a.createElement("th",null,"Guard"))),r.a.createElement("tbody",null,e.ambassadors.map((function(e){return r.a.createElement("tr",{key:e.k},r.a.createElement("td",null,e.k),r.a.createElement("td",null,g(e.active)),r.a.createElement("td",null,g(e["voted-to-freeze"])),r.a.createElement("td",null,g(e.guard)))}))))},N=function(){return r.a.createElement(k,{json:E.kadenaAPI,keyFormatter:E.keyFormatter})},L=function(){var e=Object(u.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.fetch.local({pactCode:"(".concat(E.kadenaAPI.contractAddress,".").concat(t,")"),meta:f.a.lang.mkMeta(E.kadenaAPI.meta.sender,E.kadenaAPI.meta.chainId,E.kadenaAPI.meta.gasPrice,E.kadenaAPI.meta.gasLimit,E.kadenaAPI.meta.creationTime(),E.kadenaAPI.meta.ttl)},E.kadenaAPI.meta.host);case 2:return a=e.sent,n=a.result.data,console.log("local query data",n),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(e){return r.a.createElement(k,{json:e.initState,header:["","Status"],keyFormatter:b})},G=function(){var e=Object(n.useState)({}),t=Object(m.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)([]),o=Object(m.a)(l,2),i=o[0],p=o[1],f=Object(n.useState)([]),E=Object(m.a)(f,2),h=E[0],b=E[1],g=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L("view-state");case 2:t=e.sent,c(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L("view-ambassadors");case 2:t=e.sent,b(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L("view-guardians");case 2:t=e.sent,p(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){g(),k(),v()}),[]),r.a.createElement(d.a,null,r.a.createElement("h1",null,r.a.createElement("a",null,"Welcome to DAO.init")),r.a.createElement(N,null),r.a.createElement("h2",null,"Contract State"),r.a.createElement(B,{initState:a}),r.a.createElement("h2",null,"Guardians"),r.a.createElement(R,{guardians:i}),r.a.createElement("h2",null,"Ambassadors"),r.a.createElement(D,{ambassadors:h}),r.a.createElement(T,{guardians:i}))};a(295),a(296),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,{basename:"/dao.init-frontend"},r.a.createElement(G,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t){var a="https://".concat("api.testnet.chainweb.com","/chainweb/0.0/").concat("testnet04","/chain/").concat("0","/pact"),n={contractName:"init",gasStationName:"memory-wall-gas-station",namespace:"free",contractAddress:"".concat("free",".").concat("init"),gasStationAddress:"".concat("free",".").concat("memory-wall-gas-station"),explorerURL:"https://explorer.chainweb.com/".concat("testnet04".slice(0,-2)),meta:{networkId:"testnet04",chainId:"0",host:a,creationTime:function(){return Math.round((new Date).getTime()/1e3)-15},gasPrice:1e-11,gasLimit:1e4,ttl:28800,sender:"mw-free-gas",nonce:"some nonce that doesnt matter"}};e.exports={kadenaAPI:n,keyFormatter:function(e){return e.replace(new RegExp("[A-Z]+","gm")," $&").replace(new RegExp("^[a-z]","gm"),(function(e){return e.toUpperCase()}))}}}},[[166,1,2]]]);
//# sourceMappingURL=main.7ecbba1b.chunk.js.map