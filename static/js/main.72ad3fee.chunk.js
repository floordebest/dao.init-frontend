(this["webpackJsonpdao.init-frontend"]=this["webpackJsonpdao.init-frontend"]||[]).push([[0],{165:function(e,t,a){e.exports=a(297)},179:function(e,t){},294:function(e,t,a){},297:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(30),c=a.n(l),o=a(152),u=a(12),s=a.n(u),i=a(43),m=a(23),d=a(308),E=a(306),h=a(307),p=a(309),f=a(42),b=a(311),g=a(31),k=a.n(g),v=a(8),A=function(e){return"object"===typeof e?"time"in e?e.time:"timep"in e?e.timep.split(".")[0]+"Z":"int"in e?e.int:"decimal"in e?e.decimal:JSON.stringify(e):"boolean"===typeof e?JSON.stringify(e):e},w=function(e){return r.a.createElement("table",{className:"ui very basic collapsing celled table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Guardian"),r.a.createElement("th",null,"Committed KDA"),r.a.createElement("th",null,"Approved Hash"),r.a.createElement("th",null,"Approval Date"),r.a.createElement("th",null,"Guard"))),r.a.createElement("tbody",null,e.guardians.map((function(e){return r.a.createElement("tr",{key:e.k},r.a.createElement("td",null,e.k),r.a.createElement("td",null,A(e["committed-kda"])),r.a.createElement("td",null,e["approved-hash"]),r.a.createElement("td",null,A(e["approved-date"])),r.a.createElement("td",null,A(e.guard)))}))))},x=function(e){return r.a.createElement("table",{className:"ui very basic collapsing celled table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Ambassador"),r.a.createElement("th",null,"Active"),r.a.createElement("th",null,"Voted To Freeze"),r.a.createElement("th",null,"Guard"))),r.a.createElement("tbody",null,e.ambassadors.map((function(e){return r.a.createElement("tr",{key:e.k},r.a.createElement("td",null,e.k),r.a.createElement("td",null,A(e.active)),r.a.createElement("td",null,A(e["voted-to-freeze"])),r.a.createElement("td",null,A(e.guard)))}))))},y=function(e){return r.a.createElement("table",{className:"ui very basic collapsing celled table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,"Status"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("h4",null,"Guardians")),r.a.createElement("td",null,A(e.initState["guardian-count"]))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("h4",null,"Ambassadors")),r.a.createElement("td",null,A(e.initState["ambassador-count"]))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("h4",null,"DAO Frozen Until")),r.a.createElement("td",null,A(e.initState["dao-frozen-until"]))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("h4",null,"Last Ambassador Deactivation")),r.a.createElement("td",null,A(e.initState["last-ambassador-deactivation"]))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("h4",null,"Proposed Upgrade Hash")),r.a.createElement("td",null,A(e.initState["proposed-upgrade-hash"]))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("h4",null,"Proposed Upgrade Time")),r.a.createElement("td",null,A(e.initState["proposed-upgrade-time"])))))},I=function(){var e=Object(n.useState)({}),t=Object(m.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)([]),o=Object(m.a)(c,2),u=o[0],g=o[1],A=Object(n.useState)([]),I=Object(m.a)(A,2),S=I[0],O=I[1],P=Object(n.useState)(""),j=Object(m.a)(P,2),C=j[0],N=j[1],T=Object(n.useState)({}),D=Object(m.a)(T,2),G=D[0],L=D[1],U=function(){var e=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B("view-state");case 2:t=e.sent,l(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B("view-ambassadors");case 2:t=e.sent,O(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B("view-guardians");case 2:t=e.sent,g(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){U(),H(),q()}),[]);var B=function(){var e=Object(i.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.a.fetch.local({pactCode:"(".concat(v.kadenaAPI.contractAddress,".").concat(t,")"),meta:k.a.lang.mkMeta(v.kadenaAPI.meta.sender,v.kadenaAPI.meta.chainId,v.kadenaAPI.meta.gasPrice,v.kadenaAPI.meta.gasLimit,v.kadenaAPI.meta.creationTime(),v.kadenaAPI.meta.ttl)},v.kadenaAPI.meta.host);case 2:return a=e.sent,n=a.result.data,console.log("local query data",n),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(i.a)(s.a.mark((function e(t,a,n){var r,l,c,o,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={pactCode:a,caps:k.a.lang.mkCap("Guadian Cap","Authenticates that your a guardian","".concat(v.kadenaAPI.contractAddress,".GUARDIAN"),[t]),gasLimit:v.kadenaAPI.meta.gasLimit,chainId:v.kadenaAPI.meta.chainId,ttl:v.kadenaAPI.meta.ttl,sender:t,envData:n||{}},console.log("toSign",r),e.next=5,k.a.wallet.sign(r);case 5:return l=e.sent,console.log("signed",l),L(l),e.next=10,k.a.wallet.sendSigned(l,v.kadenaAPI.meta.host);case 10:c=e.sent,console.log("txReqKeys",c),N("pending"),e.prev=13,o=8,u={};case 16:if(!(o>0)){e.next=25;break}return e.next=19,new Promise((function(e){return setTimeout(e,15e3)}));case 19:return e.next=21,k.a.fetch.poll(c,v.kadenaAPI.meta.host);case 21:u=e.sent;try{u[l.hash].result.status?o=0:o-=1}catch(s){o-=1}e.next=16;break;case 25:L(u),"success"===u[l.hash].result.status?(console.log("tx status set to success"),N("success")):(console.log("tx status set to failure"),N("failure")),e.next=35;break;case 30:e.prev=30,e.t0=e.catch(13),console.log(e.t0),console.log("tx status set to timeout"),N("timeout");case 35:e.next=42;break;case 37:e.prev=37,e.t1=e.catch(0),console.log(e.t1),console.log("tx status set to validation error"),N("validation-error");case 42:case"end":return e.stop()}}),e,null,[[0,37],[13,30]])})));return function(t,a,n){return e.apply(this,arguments)}}(),R=function(e){var t=Object(n.useState)(""),a=Object(m.a)(t,2),l=a[0],c=a[1],o=Object(n.useState)(""),u=Object(m.a)(o,2),s=u[0],i=u[1],f=Object(n.useState)(""),b=Object(m.a)(f,2),g=b[0],k=b[1];return r.a.createElement("div",null,r.a.createElement(d.a,{attached:!0,header:"Add Ambassador"}),r.a.createElement(E.a,{onSubmit:function(e){e.preventDefault(),console.log(l,s,g),J(l,"(".concat(v.kadenaAPI.contractAddress,'.register-ambassador "').concat(l,'" "').concat(s,"\" (read-keyset 'ks))"),{ks:JSON.parse(g)})},className:"attached fluid segment"},r.a.createElement(h.a,{fluid:!0,search:!0,selection:!0,placeholder:"Select Guardian",required:!0,options:e.guardians.map((function(e){return{key:e.k,value:e.k,text:e.k}})),onChange:function(e,t){c(t.value)}}),r.a.createElement(E.a.Field,{required:!0},r.a.createElement("label",null,"Ambassador Account Name"),r.a.createElement("input",{value:s,onChange:function(e){return i(e.target.value)}})),r.a.createElement(E.a.TextArea,{required:!0,label:"Ambassador Account Guard",value:g,onChange:function(e){return k(e.target.value)}}),r.a.createElement(p.a,{color:"blue",type:"submit"},"Submit")),"pending"===C?F():"success"===C?V():"failure"===C?z():"timeout"===C?W():"validation-error"===C?M():r.a.createElement("div",null))},F=function(){return r.a.createElement(d.a,{icon:!0,attached:"bottom",info:!0},r.a.createElement(f.a,{name:"circle notched",loading:!0}),r.a.createElement(d.a.Content,null,r.a.createElement(d.a.Header,null,"Transaction Sent"),"Awaiting Confirmation"))},V=function(){return r.a.createElement(d.a,{icon:!0,attached:"bottom",info:!0},r.a.createElement(f.a,{name:"check square outline"}),r.a.createElement(d.a.Content,null,r.a.createElement(d.a.Header,null,"Transaction Confirmed"),r.a.createElement("a",{href:"".concat(v.kadenaAPI.explorerURL,"/tx/").concat(G.hash)},"View transaction in Block Explorer")))},z=function(){return r.a.createElement(d.a,{icon:!0,attached:"bottom",error:!0},r.a.createElement(f.a,{name:"exclaimation circle outline"}),r.a.createElement(d.a.Content,null,r.a.createElement(d.a.Header,null,"Transaction Failure"),r.a.createElement("p",null,JSON.stringify(G)),r.a.createElement("a",{href:"".concat(v.kadenaAPI.explorerURL,"/tx/").concat(G.hash)},"View transaction in Block Explorer")))},M=function(){return r.a.createElement(d.a,{icon:!0,attached:"bottom",error:!0},r.a.createElement(f.a,{name:"exclaimation circle outline"}),r.a.createElement(d.a.Content,null,r.a.createElement(d.a.Header,null,"Transaction Validation Failure"),"Transaction was not sent to Blockchain. Check your keys or metadata"))},W=function(){return r.a.createElement(d.a,{icon:!0,attached:"bottom",warning:!0},r.a.createElement(f.a,{name:"hourglass outline"}),r.a.createElement(d.a.Content,null,r.a.createElement(d.a.Header,null,"Transaction Timeout"),"...but your tx was sent.",r.a.createElement("a",{href:"".concat(v.kadenaAPI.explorerURL,"/tx/").concat(G.hash)},"View transaction in Block Explorer")))};return r.a.createElement("div",null,r.a.createElement(b.a,{raised:!0,padded:"very"},r.a.createElement("div",{style:{margin:30}},r.a.createElement("h1",null,r.a.createElement("a",null,"Welcome to DAO.init")),r.a.createElement("table",{className:"ui very basic collapsing celled table"},r.a.createElement("thead",null,r.a.createElement("tr",null)),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("h4",null,"Contract Address")),r.a.createElement("td",null,v.kadenaAPI.contractAddress)),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("h4",null,"Chain ID")),r.a.createElement("td",null,v.kadenaAPI.meta.chainId)),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("h4",null,"Network ID")),r.a.createElement("td",null,v.kadenaAPI.meta.networkId)))),r.a.createElement("h2",null,"Contract State"),r.a.createElement(y,{initState:a}),r.a.createElement("h2",null,"Guardians"),r.a.createElement(w,{guardians:u}),r.a.createElement("h2",null,"Ambassadors"),r.a.createElement(x,{ambassadors:S}),r.a.createElement(R,{guardians:u}))))};a(294),a(295),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,{basename:"/dao.init-frontend"},r.a.createElement(I,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t){var a="https://".concat("api.testnet.chainweb.com","/chainweb/0.0/").concat("testnet04","/chain/").concat("0","/pact"),n={contractName:"init",gasStationName:"memory-wall-gas-station",namespace:"free",contractAddress:"".concat("free",".").concat("init"),gasStationAddress:"".concat("free",".").concat("memory-wall-gas-station"),explorerURL:"https://explorer.chainweb.com/".concat("testnet04".slice(0,-2)),meta:{networkId:"testnet04",chainId:"0",host:a,creationTime:function(){return Math.round((new Date).getTime()/1e3)-15},gasPrice:1e-11,gasLimit:1e4,ttl:28800,sender:"mw-free-gas",nonce:"some nonce that doesnt matter"}};e.exports={kadenaAPI:n}}},[[165,1,2]]]);
//# sourceMappingURL=main.72ad3fee.chunk.js.map